post_install() {
  post_upgrade
}

post_upgrade() {
  getent group "minecraft" &>/dev/null || groupadd -r minecraft 1>/dev/null
  getent passwd "minecraft" &>/dev/null || useradd -r -g minecraft -d "/var/empty" -s "/bin/sh" minecraft 1>/dev/null
  chown -R minecraft:minecraft "/srv/minecraft" 1>/dev/null
  chown -R minecraft:minecraft "/var/run/minecraft-server" 1>/dev/null
  chown -R minecraft:minecraft "/var/log/minecraft-server" 1>/dev/null
  cat << EOF
==> When running as a daemon, world data are stored in /srv/minecraft,
==> and you can access the server console by running as root
      $ attachtty /var/run/minecraft-server/socket
EOF
}

post_remove() {
  if getent passwd "minecraft" >/dev/null; then
    userdel minecraft >/dev/null
  fi
  if getent group "minecraft" >/dev/null; then
    groupdel minecraft >/dev/null
  fi
}
